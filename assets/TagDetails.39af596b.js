import{d as a,e,_ as t,I as l,u as s,N as n,y as r,r as o,O as c,o as i,z as u,D as f,J as g,E as d,L as m,f as p,a as x,c as T,g as v,t as k,q as y,h,F as w}from"./index.eca2312c.js";import{_ as b}from"./LabeledInput.ce27a152.js";import"./Loading.4e712f09.js";import{_ as I}from"./Dropdown.bf3843a3.js";import{a as N,_,b as G}from"./TagStepTrack.5cd92d38.js";var L=a({name:"TagDetails",components:{Textfield:e,Dropdown:I,LabeledInput:b,Button:t,TagStepImage:N,TagStepTrack:_,TagEntry:l},props:{tagId:{type:String,required:!0}},setup(a){const e=s(),t=n(),l=r((()=>t.name)),p=o(),x=o(),T=c(p),v=r({get:()=>p.value&&new m(p.value.group),set:a=>{p.value&&(p.value.group=(null==a?void 0:a.value)||"")}}),k=async()=>{var a;if(p.value&&(null==(a=x.value)?void 0:a.uri)!==p.value.trackUri)try{x.value=await G(p.value)}catch(e){console.error("ERROR:",e)}};return i((async()=>{try{p.value=await u.service("nfc-tags").get(a.tagId)}catch(t){e.push({name:"tag-not-found"})}await k(),await f()})),g((()=>t.name),k),{nfcTag:p,nfcTagTrack:x,nfcTagGroup:v,isNfcTagValid:T,saveNfcTag:async()=>{p.value&&(await u.service("nfc-tags").update(p.value._id,p.value),alert("Tag erfolgreich gespeichert."),await e.push({name:"home"}))},routeName:l,router:e,tagGroupListItems:d}}});const V={class:"mx-auto h-full w-full flex flex-col overflow-hidden"},j={class:"p-8 flex flex-row items-center space-x-5"},D={class:"ml-2 flex flex-col"},S=v("span",{class:"font-heading font-extralight text-2xl"},"Tag Editieren",-1),U={key:0,class:"text-m opacity-40"},C={key:0,class:"overflow-x-hidden overflow-y-auto bg-gradient-to-b from-primary to-secondary flex flex-col items-start justify-start text-2xl text-gray-800 flex-grow"},B={key:0,class:"tag-edit flex flex-col w-full p-4"},E={class:"flex flex-row items-center"},M={key:0},R={class:"flex flex-row items-center"},q={class:"py-5 flex-grow-0 flex items-center justify-evenly text-2xl text-gray-800"};L.render=function(a,e,t,l,s,n){const r=p("Button"),o=p("Textfield"),c=p("LabeledInput"),i=p("Dropdown"),u=p("TagEntry"),f=p("TagStepImage"),g=p("TagStepTrack");return x(),T("div",V,[v("header",j,[v(r,{back:"",round:"",icon:"fas fa-times",class:"h-10 w-10 flex-shrink-0",text:""}),v("div",D,[S,a.nfcTag?(x(),T("span",U,"Tag-ID: #"+k(a.nfcTag.nfcData),1)):y("",!0)])]),a.nfcTag?(x(),T("main",C,["tag-details"===a.routeName?(x(),T("div",B,[v(c,{label:"Name"},{default:h((()=>[v(o,{modelValue:a.nfcTag.name,"onUpdate:modelValue":e[1]||(e[1]=e=>a.nfcTag.name=e),placeholder:"z. B. Mario Figur",class:"rounded-full"},null,8,["modelValue"])])),_:1}),v(c,{label:"Gruppe"},{default:h((()=>[v(i,{modelValue:a.nfcTagGroup,"onUpdate:modelValue":e[2]||(e[2]=e=>a.nfcTagGroup=e),items:a.tagGroupListItems,"onUpdate:items":e[3]||(e[3]=e=>a.tagGroupListItems=e),removeable:!1,"placeholder-text":"W채hle eine Gruppe","enable-add-item":!0},null,8,["modelValue","items"])])),_:1}),v(c,{label:"Musik"},{default:h((()=>[v("div",E,[a.nfcTagTrack?(x(),T("span",M,k(a.nfcTagTrack.title),1)):y("",!0),v(r,{class:"p-3 px-6 ml-auto",text:"Musik 채ndern",onClick:e[4]||(e[4]=e=>a.router.push({name:"tag-edit-track"}))})])])),_:1}),v(c,{label:"Bild"},{default:h((()=>[v("div",R,[v(u,{class:"w-32",img:a.nfcTag.imageUrl},null,8,["img"]),v(r,{class:"p-3 px-6 ml-auto",text:"Bild 채ndern",onClick:e[5]||(e[5]=e=>a.router.push({name:"tag-edit-image"}))})])])),_:1})])):"tag-edit-image"===a.routeName?(x(),T(f,{key:1,"nfc-tag":a.nfcTag,"onUpdate:nfc-tag":e[6]||(e[6]=e=>a.nfcTag=e)},null,8,["nfc-tag"])):"tag-edit-track"===a.routeName?(x(),T(g,{key:2,"nfc-tag":a.nfcTag,"onUpdate:nfc-tag":e[7]||(e[7]=e=>a.nfcTag=e)},null,8,["nfc-tag"])):y("",!0)])):y("",!0),v("footer",q,["tag-details"!==a.routeName?(x(),T(w,{key:0},[v(r,{icon:"fas fa-caret-left",class:"w-14 h-14 ml-4",round:"",onClick:e[8]||(e[8]=e=>a.router.go(-1))}),v(r,{text:"Ausw채hlen",class:"p-3 mx-4 flex-1",onClick:e[9]||(e[9]=e=>a.router.go(-1))})],64)):(x(),T(r,{key:1,text:"Speichern",class:"p-3 mx-4 flex-1",enabled:a.isNfcTagValid,onClick:a.saveNfcTag},null,8,["enabled","onClick"]))])])};export default L;
