import{_ as e}from"./LabeledInput.74d0d5b2.js";import{H as a,d as l,B as t,f as s,r as n,C as i,b as r,Q as c,h as o,a as u,c as d,j as f,k as g,i as p,R as m,o as v,p as x,m as h,t as y,F as w,v as k,n as T,S as b}from"./index.4ac08c93.js";import{_ as U}from"./Loading.db0753ab.js";async function I(e){return await a.service("spotify-tracks").get(e.trackUri)}const S=/((https)|(http)):\/\/.*/i;var L=l({name:"TagStepImage",components:{LabeledInput:e,TagEntry:t,Textfield:s},props:{nfcTag:{type:Object,required:!0}},emits:{"update:nfc-tag":e=>!0,"update:is-valid":e=>!0},setup(e,a){const l=n(),t=n(),s=i((()=>t.value&&!S.test(t.value)?null:t.value)),o=n(null),u=i({get:()=>e.nfcTag.imageUrl,set:l=>{const t=e.nfcTag;t.imageUrl=l,a.emit("update:nfc-tag",t),a.emit("update:is-valid",""!==l)}});return r((async()=>{const a=await I(e.nfcTag);l.value=a.imageUri,u.value!==l.value?S.test(u.value)&&(t.value=u.value,o.value="external"):o.value="spotify"})),c(o,(e=>{"spotify"===e&&l.value&&(u.value=l.value),"external"===e&&(u.value=t.value||"")})),c(t,(()=>{u.value=t.value||""})),{imageSource:o,spotifyImageUrl:l,sanitizedExternalImageUrl:s,externalImageUrl:t}}});const j={class:"add-tag-step-image flex flex-grow flex-col justify-start items-start px-8 py-5"},E={class:"flex content-end"},_={class:"flex content-end"};L.render=function(e,a,l,t,s,n){const i=o("TagEntry"),r=o("LabeledInput"),c=o("Textfield");return u(),d("div",j,[f(r,{label:"Bild von Spotify"},{default:g((()=>[f("div",E,[f(i,{class:"w-44 cursor-pointer",img:e.spotifyImageUrl||"/image-gallery.svg",selected:"spotify"===e.imageSource,onClick:a[1]||(a[1]=a=>e.imageSource="spotify")},null,8,["img","selected"])])])),_:1}),f(r,{label:"Eigenes Bild",class:"mt-8"},{default:g((()=>[f("div",_,[f(i,{class:"w-44 cursor-pointer",img:e.sanitizedExternalImageUrl||"/image-gallery.svg",selected:"external"===e.imageSource,onClick:a[2]||(a[2]=a=>e.imageSource="external")},null,8,["img","selected"])]),"external"===e.imageSource?(u(),d(c,{key:0,modelValue:e.externalImageUrl,"onUpdate:modelValue":a[3]||(a[3]=a=>e.externalImageUrl=a),class:"mt-2 w-full",placeholder:"Bild URL"},null,8,["modelValue"])):p("",!0)])),_:1})])};var V=l({name:"TagStepTrack",components:{Textfield:s,TagEntry:t,Loading:U},props:{nfcTag:{type:Object,required:!0}},emits:{"update:nfc-tag":e=>!0,"update:is-valid":e=>!0},setup(e,l){const t=n(""),s=n(!1),i=n([]),r=n(),o=m.debounce((async()=>{i.value=await async function(e){const l={query:{name:e}};return await a.service("spotify-tracks").find(l)}(t.value),s.value=!1}),500);c(t,(async e=>{e.length>=3&&(s.value=!0,await o())}));return v((async()=>{if(e.nfcTag.trackUri){const a=await I(e.nfcTag);t.value=a.title,r.value=a}})),{search:t,isLoading:s,tracks:i,changeTrack:a=>{r.value=a;const t=e.nfcTag;t.trackUri=a.uri;const s=!!a.uri;l.emit("update:nfc-tag",t),l.emit("update:is-valid",s)},selectedTrack:r}}});const C=T("data-v-62ae97f6");x("data-v-62ae97f6");const B={class:"add-tag-step-track flex flex-col relative h-full w-full"},q={class:"search px-4"},z={key:0,class:"loading flex m-auto p-2"},O={key:1,class:"flex m-auto text-center p-2"},R=f("p",{class:"text-white font-heading text-3xl max-w-2/3 p-10/100 mx-auto"}," Wähle ein schönes Lied für deinen Tag! ",-1),F={key:2,class:"m-auto text-center justify-center p-2"},H=f("img",{class:"mb-4",src:b},null,-1),K={class:"text-white font-heading text-2xl"},Q=f("p",null,"Keine Ergebnisse für",-1),W={key:3,class:"flex flex-col mt-4 pb-6 w-full overflow-y-auto max-h-full"},A={class:"flex flex-col text-white overflow-hidden"},D={class:"ml-4 text-lg font-bold whitespace-nowrap overflow-hidden overflow-ellipsis"},G={class:"ml-4 text-base whitespace-nowrap overflow-hidden overflow-ellipsis"};h();const J=C(((e,a,l,t,s,n)=>{const i=o("Textfield"),r=o("Loading"),c=o("TagEntry");return u(),d("div",B,[f("div",q,[f(i,{modelValue:e.search,"onUpdate:modelValue":a[1]||(a[1]=a=>e.search=a),class:"w-full",placeholder:"Suche einen Titel ...",icon:"fas fa-search"},null,8,["modelValue"])]),e.isLoading?(u(),d("div",z,[f(r)])):e.search.length<3?(u(),d("div",O,[R])):e.search.length>=3&&0===e.tracks.length?(u(),d("div",F,[H,f("span",K,[Q,f("p",null,'"'+y(e.search)+'"',1)])])):(u(),d("ul",W,[(u(!0),d(w,null,k(e.tracks,(a=>(u(),d("li",{key:a.uri,class:["flex flex-row py-2 px-2 rounded-2xl w-5/6 mx-auto cursor-pointer border border-transparent",{"shadow-xl border-yellow-400":e.selectedTrack&&a.uri===e.selectedTrack.uri}],onClick:l=>e.changeTrack(a)},[f(c,{img:a.imageUri,class:"w-20 h-20 flex-shrink-0"},null,8,["img"]),f("div",A,[f("span",D,y(a.title),1),f("span",G,y(a.artist),1)])],10,["onClick"])))),128))]))])}));V.render=J,V.__scopeId="data-v-62ae97f6";export{V as _,L as a,I as g};
