import{d as a,e,_ as l,H as t,u as s,M as n,y as o,r as c,N as r,o as i,B as u,C as g,D as f,L as d,f as m,a as p,c as v,g as x,t as T,q as k,h as y,F as w}from"./index.826a8f32.js";import{_ as h}from"./LabeledInput.65b97091.js";import"./Loading.3f5c4146.js";import{_ as b}from"./Dropdown.d69a0ce6.js";import{a as I,_ as N,b as U}from"./TagStepTrack.b83eccab.js";var C=a({name:"TagDetails",components:{Textfield:e,Dropdown:b,LabeledInput:h,Button:l,TagStepImage:I,TagStepTrack:N,TagEntry:t},props:{tagId:{type:String,required:!0}},setup(a){const e=s(),l=n(),t=o((()=>l.name)),m=c(),p=c(),v=c(),x=c(),T=r(m),k=o({get:()=>m.value&&new d(m.value.group),set:a=>{m.value&&(m.value.group=(null==a?void 0:a.value)||"")}}),y=async()=>{var a;if(m.value&&(null==(a=p.value)?void 0:a.uri)!==m.value.trackUri)try{p.value=await U(m.value)}catch(e){console.error("ERROR:",e)}};return i((async()=>{try{m.value=await u.service("nfc-tags").get(a.tagId)}catch(l){e.push({name:"tag-not-found"})}await y(),await g()})),{nfcTag:m,nfcTagTrack:p,nfcTagGroup:k,isNfcTagValid:T,saveNfcTag:async()=>{m.value&&(await u.service("nfc-tags").update(m.value._id,m.value),alert("Tag erfolgreich gespeichert."),await e.push({name:"home"}))},routeName:t,tagGroupListItems:f,presaveOldTrack:async()=>{m.value&&x.value&&(x.value=m.value,v.value=await U(m.value),e.push({name:"tag-edit-track"}))},choose:async()=>{await y(),await(async()=>{if(v.value&&m.value&&v.value.imageUri===m.value.imageUrl){const a=await U(m.value);m.value.imageUrl=a.imageUri}})(),e.go(-1)},goBack:()=>{x.value&&(m.value=x.value,e.go(-1))}}}});const _={class:"mx-auto h-full w-full flex flex-col overflow-hidden"},B={class:"p-8 flex flex-row items-center space-x-5"},G={class:"ml-2 flex flex-col"},L=x("span",{class:"font-heading font-extralight text-2xl"},"Tag Editieren",-1),V={key:0,class:"text-m opacity-40"},j={key:0,class:"overflow-x-hidden overflow-y-auto bg-gradient-to-b from-primary to-secondary flex flex-col items-start justify-start text-2xl text-gray-800 flex-grow"},D={key:0,class:"tag-edit flex flex-col w-full p-4"},S={class:"flex flex-row items-center"},E={key:0},M={class:"flex flex-row items-center"},O={class:"py-5 flex-grow-0 flex items-center justify-evenly text-2xl text-gray-800"};C.render=function(a,e,l,t,s,n){const o=m("Button"),c=m("Textfield"),r=m("LabeledInput"),i=m("Dropdown"),u=m("TagEntry"),g=m("TagStepImage"),f=m("TagStepTrack");return p(),v("div",_,[x("header",B,[x(o,{back:"",icon:"fas fa-times",size:"md"}),x("div",G,[L,a.nfcTag?(p(),v("span",V,"Tag-ID: #"+T(a.nfcTag.nfcData),1)):k("",!0)])]),a.nfcTag?(p(),v("main",j,["tag-details"===a.routeName?(p(),v("div",D,[x(r,{label:"Name"},{default:y((()=>[x(c,{modelValue:a.nfcTag.name,"onUpdate:modelValue":e[1]||(e[1]=e=>a.nfcTag.name=e),placeholder:"z. B. Mario Figur",class:"rounded-full"},null,8,["modelValue"])])),_:1}),x(r,{label:"Gruppe"},{default:y((()=>[x(i,{modelValue:a.nfcTagGroup,"onUpdate:modelValue":e[2]||(e[2]=e=>a.nfcTagGroup=e),items:a.tagGroupListItems,"onUpdate:items":e[3]||(e[3]=e=>a.tagGroupListItems=e),removeable:!1,"placeholder-text":"W채hle eine Gruppe","enable-add-item":!0},null,8,["modelValue","items"])])),_:1}),x(r,{label:"Musik"},{default:y((()=>[x("div",S,[a.nfcTagTrack?(p(),v("span",E,T(a.nfcTagTrack.title),1)):k("",!0),x(o,{text:"Musik 채ndern",class:"px-3 ml-auto",onClick:a.presaveOldTrack},null,8,["onClick"])])])),_:1}),x(r,{label:"Bild"},{default:y((()=>[x("div",M,[x(u,{class:"w-44",img:a.nfcTag.imageUrl},null,8,["img"]),x(o,{text:"Bild 채ndern",class:"px-3 ml-auto",to:{name:"tag-edit-image"}})])])),_:1})])):"tag-edit-image"===a.routeName?(p(),v(g,{key:1,"nfc-tag":a.nfcTag,"onUpdate:nfc-tag":e[4]||(e[4]=e=>a.nfcTag=e)},null,8,["nfc-tag"])):"tag-edit-track"===a.routeName?(p(),v(f,{key:2,"nfc-tag":a.nfcTag,"onUpdate:nfc-tag":e[5]||(e[5]=e=>a.nfcTag=e)},null,8,["nfc-tag"])):k("",!0)])):k("",!0),x("footer",O,["tag-details"!==a.routeName?(p(),v(w,{key:0},[x(o,{icon:"fas fa-caret-left",class:"ml-4",onClick:a.goBack},null,8,["onClick"]),x(o,{text:"Ausw채hlen",class:"mx-4 flex-grow",onClick:a.choose},null,8,["onClick"])],64)):(p(),v(o,{key:1,text:"Speichern",class:"mx-4 flex-grow",enabled:a.isNfcTagValid,onClick:a.saveNfcTag},null,8,["enabled","onClick"]))])])};export default C;
