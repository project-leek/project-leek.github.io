import{d as a,f as e,_ as t,N as l,u as s,R as n,H as i,r as c,S as r,o,E as d,I as f,O as g,J as u,L as m,h as p,a as x,c as T,j as v,t as y,i as k,k as w}from"./index.10935ede.js";import{a as h,_ as b,b as I}from"./TagStepTrack.e3c2cda9.js";import{_ as N}from"./Dropdown.acabbfe5.js";import{_ as U}from"./LabeledInput.c46b1996.js";import"./Loading.d59de5b8.js";var _=a({name:"TagDetails",components:{Textfield:e,Dropdown:N,LabeledInput:U,Button:t,TagStepImage:h,TagStepTrack:b,TagEntry:l},props:{tagId:{type:String,required:!0}},setup(a){const e=s(),t=n(),l=i((()=>t.name)),p=c(),x=c(),T=r(p),v=i({get:()=>p.value&&new m(p.value.group),set:a=>{p.value&&(p.value.group=(null==a?void 0:a.value)||"")}});o((async()=>{try{p.value=await d.service("nfc-tags").get(a.tagId)}catch(t){e.push({name:"tag-not-found"})}await f()})),g((()=>{var a;return null==(a=p.value)?void 0:a.trackUri}),(async a=>{p.value&&(x.value&&a===x.value.uri||(x.value=await I(p.value)),p.value.imageUrl)}));return{nfcTag:p,nfcTagTrack:x,nfcTagGroup:v,isNfcTagValid:T,saveNfcTag:async()=>{p.value&&(await d.service("nfc-tags").update(p.value._id,p.value),alert("Tag erfolgreich gespeichert."),await e.push({name:"home"}))},routeName:l,tagGroupListItems:u,cut:(a,e)=>a.length<e?a:`${a.substr(0,e)} ...`}}});const j={class:"mx-auto h-full w-full flex flex-col overflow-hidden"},G={class:"p-4 flex flex-row items-center space-x-5"},L={class:"ml-2 flex flex-col"},S=v("span",{class:"font-heading font-extralight text-2xl"},"Tag Editieren",-1),V={key:0,class:"text-m opacity-40"},z={key:0,class:"overflow-x-hidden overflow-y-auto bg-gradient-to-b from-primary to-secondary flex flex-col items-start justify-start text-2xl text-gray-800 flex-grow"},D={key:0,class:"tag-edit flex flex-col w-full p-4"},B={class:"flex flex-row items-center"},E={class:"flex relative bg-gray-100 rounded-2xl p-4 w-44 h-44 overflow-hidden"},M=v("img",{class:"absolute w-80/100 top-10/100 left-10/100 opacity-5",src:"/assets/spotify.72c4f97f.png"},null,-1),C={key:0,class:"w-full text-center my-auto overflow-hidden"},q={class:"flex flex-row items-center"},A={class:"py-5 flex-grow-0 flex items-center justify-evenly text-2xl text-gray-800"};_.render=function(a,e,t,l,s,n){const i=p("Button"),c=p("Textfield"),r=p("LabeledInput"),o=p("Dropdown"),d=p("TagEntry"),f=p("TagStepImage"),g=p("TagStepTrack");return x(),T("div",j,[v("header",G,[v(i,{back:"",icon:"fas fa-times",size:"md"}),v("div",L,[S,a.nfcTag?(x(),T("span",V,"Tag-ID: #"+y(a.nfcTag.nfcData),1)):k("",!0)])]),a.nfcTag?(x(),T("main",z,["tag-details"===a.routeName?(x(),T("div",D,[v(r,{label:"Name"},{default:w((()=>[v(c,{modelValue:a.nfcTag.name,"onUpdate:modelValue":e[1]||(e[1]=e=>a.nfcTag.name=e),placeholder:"z. B. Mario Figur",class:"rounded-full"},null,8,["modelValue"])])),_:1}),v(r,{label:"Gruppe",class:"mt-8"},{default:w((()=>[v(o,{modelValue:a.nfcTagGroup,"onUpdate:modelValue":e[2]||(e[2]=e=>a.nfcTagGroup=e),items:a.tagGroupListItems,"onUpdate:items":e[3]||(e[3]=e=>a.tagGroupListItems=e),removeable:!1,"placeholder-text":"W채hle eine Gruppe","enable-add-item":!0},null,8,["modelValue","items"])])),_:1}),v(r,{label:"Musik",class:"mt-8"},{default:w((()=>[v("div",B,[v("div",E,[M,a.nfcTagTrack?(x(),T("span",C,y(a.cut(a.nfcTagTrack.title,42)),1)):k("",!0)]),v(i,{icon:"far fa-edit",text:"Musik 채ndern",class:"hidden md:flex ml-auto",size:"lg",to:{name:"tag-edit-track"}}),v(i,{icon:"far fa-edit",class:"md:hidden ml-auto",size:"lg",to:{name:"tag-edit-track"}})])])),_:1}),v(r,{label:"Bild",class:"mt-8"},{default:w((()=>[v("div",q,["spotify"===a.nfcTag.imageUrl&&a.nfcTagTrack?(x(),T(d,{key:0,class:"w-44",img:a.nfcTagTrack.imageUri},null,8,["img"])):(x(),T(d,{key:1,class:"w-44",img:a.nfcTag.imageUrl},null,8,["img"])),v(i,{icon:"far fa-edit",class:"md:hidden ml-auto",size:"lg",to:{name:"tag-edit-image"}}),v(i,{icon:"far fa-edit",text:"Bild 채ndern",class:"hidden md:flex ml-auto",size:"lg",to:{name:"tag-edit-image"}})])])),_:1})])):"tag-edit-image"===a.routeName?(x(),T(f,{key:1,"nfc-tag":a.nfcTag,"onUpdate:nfc-tag":e[4]||(e[4]=e=>a.nfcTag=e)},null,8,["nfc-tag"])):"tag-edit-track"===a.routeName?(x(),T(g,{key:2,"nfc-tag":a.nfcTag,"onUpdate:nfc-tag":e[5]||(e[5]=e=>a.nfcTag=e)},null,8,["nfc-tag"])):k("",!0)])):k("",!0),v("footer",A,["tag-details"!==a.routeName?(x(),T(i,{key:0,text:"Ausw채hlen",class:"mx-4 flex-grow",back:""})):(x(),T(i,{key:1,text:"Speichern",class:"mx-4 flex-grow",disabled:!a.isNfcTagValid,onClick:a.saveNfcTag},null,8,["disabled","onClick"]))])])};export default _;
