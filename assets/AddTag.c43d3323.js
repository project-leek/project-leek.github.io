import{d as e,f as a,r as t,C as l,o as s,K as n,M as o,L as c,h as r,a as i,c as d,j as u,k as p,u as f,H as m,N as g,O as v,_ as x,t as h,i as T,P as w,F as b,v as y}from"./index.b14460f5.js";import{_ as k,a as S}from"./TagStepTrack.d06f3800.js";import{_ as j}from"./Dropdown.931d1608.js";import{_ as V}from"./LabeledInput.b49b45b7.js";import{N as D}from"./nfc-tag.class.5688d583.js";import"./Loading.2b52e5e2.js";var I=e({name:"TagStepInfo",components:{Textfield:a,Dropdown:j,LabeledInput:V},props:{nfcTag:{type:Object,required:!0}},emits:{"update:nfc-tag":e=>!0,"update:is-valid":e=>!0},setup(e,a){const r=t(e.nfcTag),i=l({get:()=>r.value.group?new c(r.value.group):null,set:e=>e&&u("group",e.value)}),d=l({get:()=>r.value.name,set:e=>u("name",e)});function u(e,t){r.value[e]=t;const l=!(!r.value.group||!r.value.name);a.emit("update:nfc-tag",r.value),a.emit("update:is-valid",l)}return s((async()=>{await n()})),{tagName:d,tagGroupListItems:o,selectedGroup:i}}});const N={class:"w-full p-4 h-full flex flex-col items-center"};I.render=function(e,a,t,l,s,n){const o=r("Textfield"),c=r("LabeledInput"),f=r("Dropdown");return i(),d("div",N,[u(c,{label:"Tag Name",class:"w-full"},{default:p((()=>[u(o,{modelValue:e.tagName,"onUpdate:modelValue":a[1]||(a[1]=a=>e.tagName=a),placeholder:"z. B. Mario Figur",class:"rounded-full"},null,8,["modelValue"])])),_:1}),u(c,{label:"Gruppe",class:"w-full mt-8"},{default:p((()=>[u(f,{modelValue:e.selectedGroup,"onUpdate:modelValue":a[2]||(a[2]=a=>e.selectedGroup=a),items:e.tagGroupListItems,"onUpdate:items":a[3]||(a[3]=a=>e.tagGroupListItems=a),removeable:!1,"placeholder-text":"Wähle eine Gruppe","enable-add-item":""},null,8,["modelValue","items"])])),_:1})])};var C=e({name:"TagStepPlaceOnReader",props:{nfcTag:{type:Object,default:null}},emits:{proceed:()=>!0,"update:nfc-tag":e=>!0,"update:is-valid":e=>!0},setup(e,a){const l=t(new D),n=f(),o=e=>{(async()=>{if(!e.attachedTagData)return;const t=await v(e.attachedTagData);t?await n.replace({name:"tag-details",params:{tagId:t._id}}):(l.value.nfcData=e.attachedTagData,a.emit("update:nfc-tag",l.value),a.emit("proceed"))})()};s((()=>{a.emit("update:nfc-tag",l.value),m.service("nfc-readers").on("patched",o).on("updated",o)})),g((()=>{m.service("nfc-readers").off("patched",o).off("updated",o)}))}});const G={class:"add-tag-step-place-tag-on-reader p-6 flex h-full w-full my-auto"},L=u("img",{class:"object-contain",src:"/assets/attach-tag.e618a177.gif"},null,-1);C.render=function(e,a,t,l,s,n){return i(),d("div",G,[L])};var _=e({name:"AddTag",components:{Button:x},setup(){const e=t(null),a=[{component:C,title:"Tag scannen"},{component:I,title:"Tag anlegen"},{component:k,title:"Musik auswählen"},{component:S,title:"Bild auswählen"}],l=t(0),s=t(!1),n=f();return{activeStep:l,steps:a,nfcTag:e,saveTag:async()=>{e.value&&(await m.service("nfc-tags").create(e.value),n.push({name:"home"}),alert("Neuen Tag erfolgreich erstellt."))},previousStep:()=>{s.value=!0,l.value-=1},nextStep:()=>{s.value=!1,l.value+=1},dataValid:s}}});const U={class:"add-tag w-full flex flex-col"},B={class:"p-4 flex flex-row items-start"},F={class:"headlines ml-2 flex flex-col my-auto"},O={class:"text-3xl"},P={key:0,class:"italic font-thin text-black text-opacity-30"},M={class:"bg-gradient-to-b from-primary to-secondary w-full flex flex-col flex-grow overflow-y-auto"},z={class:"flex flex-col items-center"},R={class:"steps flex flex-row justify-center transform -translate-y-3 bg-white rounded-t-md px-2 py-1"},W={class:"actions flex flex-row w-full justify-center mb-4 px-4"},q={key:3,class:"text-center"};_.render=function(e,a,t,l,s,n){const o=r("Button");return i(),d("div",U,[u("header",B,[u(o,{back:"",icon:"fas fa-times",size:"md"}),u("div",F,[u("span",O,h(e.steps[e.activeStep].title||"Neuen Tag anlegen"),1),e.nfcTag&&e.nfcTag.nfcData?(i(),d("span",P,"Tag-ID #"+h(e.nfcTag.nfcData),1)):T("",!0)])]),u("main",M,[(i(),d(w(e.steps[e.activeStep].component),{"nfc-tag":e.nfcTag,"onUpdate:nfc-tag":a[1]||(a[1]=a=>e.nfcTag=a),"onUpdate:isValid":a[2]||(a[2]=a=>e.dataValid=a),onProceed:e.nextStep},null,8,["nfc-tag","onProceed"]))]),u("footer",z,[u("ul",R,[(i(!0),d(b,null,y(e.steps.length,(a=>(i(),d("li",{key:a,class:"mx-2"},h(e.activeStep===a-1?"x":"o"),1)))),128))]),u("div",W,[0!==e.activeStep?(i(),d(o,{key:0,icon:"fas fa-chevron-left",class:"mr-4",onClick:e.previousStep},null,8,["onClick"])):T("",!0),e.activeStep===e.steps.length-1?(i(),d(o,{key:1,round:"",class:"flex-grow",icon:"fas fa-download",text:"Tag erstellen",disabled:!e.dataValid,onClick:e.saveTag},null,8,["disabled","onClick"])):0!==e.activeStep?(i(),d(o,{key:2,class:"flex-grow",icon:"fas fa-chevron-right","icon-right":"",text:"Weiter",disabled:!e.dataValid,onClick:e.nextStep},null,8,["disabled","onClick"])):(i(),d("span",q,"Zum Fortfahren bitte NFC Tag an den Reader halten!"))])])])};export default _;
