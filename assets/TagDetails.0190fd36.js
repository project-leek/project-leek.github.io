import{d as e,e as a,_ as l,m as t,r as n,o as s,n as u,f as o,a as r,c,g as i,h as d,u as p,s as f,q as g,t as m,v,x}from"./index.3da84c45.js";import{_ as T}from"./LabeledInput.f4b141a0.js";import"./Loading.bf0970cc.js";import{_ as y,a as h}from"./AddTagStepTrack.7b7d57b7.js";import{_ as k,L as w}from"./Dropdown.1633262f.js";var D=e({name:"EditTag",components:{Textfield:a,Dropdown:k,LabeledInput:T,Button:l,TagEntry:t},props:{nfcTag:{type:Object,required:!0}},emits:{"update:nfc-tag":null,"open-image-details":null,"open-track-details":null},setup(e,a){const l=n(e.nfcTag),t=n([]),o=n([]),r=n(),c=n(),i=n("");return s((async()=>{await async function(){const e=await u.service("nfc-tags").find();e instanceof Array?e.map((e=>{e.group&&!t.value.includes(e.group)&&t.value.push(e.group)})):e.data.map((e=>{e.group&&!t.value.includes(e.group)&&t.value.push(e.group)})),t.value.includes(l.value.group)||t.value.push(l.value.group),t.value.map((e=>o.value.push(new w(e,e)))),r.value=o.value.find((e=>e.value===l.value.group))}(),await async function(){const e={},a=l.value.trackUri;try{c.value=await u.service("spotify-tracks").get(a,e),c.value&&(i.value=c.value.title)}catch(t){console.log("ERROR:",t)}}()})),{currentTag:l,groupListItems:o,selectedGroup:r,selectGroup:function(){var e;l.value.group=(null==(e=r.value)?void 0:e.value)||"",a.emit("update:nfc-tag",l)},selectedTrackName:i}}});const b={class:"w-full p-4 px-6 items-center space-y-6"},I={class:"flex flex-row w-full"};D.render=function(e,a,l,t,n,s){const u=o("Textfield"),p=o("LabeledInput"),f=o("Dropdown"),g=o("TagEntry"),m=o("Button");return r(),c("div",b,[i(p,{label:"Tag Name",class:"w-full col-span-2"},{default:d((()=>[i(u,{modelValue:e.currentTag.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentTag.name=a),placeholder:"z. B. Mario Figur",class:"rounded-full",required:!0,"onUpdate:nfcTag":a[2]||(a[2]=a=>e.$emit("update:nfc-tag",e.currentTag))},null,8,["modelValue","placeholder"])])),_:1}),i(p,{label:"Gruppe",class:"w-full col-span-2"},{default:d((()=>[i(f,{modelValue:e.selectedGroup,"onUpdate:modelValue":[a[3]||(a[3]=a=>e.selectedGroup=a),e.selectGroup],items:e.groupListItems,"onUpdate:items":a[4]||(a[4]=a=>e.groupListItems=a),removeable:!1,"placeholder-text":"Wähle eine Gruppe","enable-add-item":!0,required:!0},null,8,["modelValue","items","onUpdate:modelValue"])])),_:1}),i(p,{label:"Tag Track",class:"w-full col-span-2"},{default:d((()=>[i(u,{modelValue:e.selectedTrackName,"onUpdate:modelValue":a[5]||(a[5]=a=>e.selectedTrackName=a),placeholder:"z. B. Never gonna give you up",class:"rounded-full","onUpdate:nfcTag":a[6]||(a[6]=a=>e.$emit("update:nfc-tag",e.currentTag)),onClick:a[7]||(a[7]=a=>e.$emit("open-track-details"))},null,8,["modelValue","placeholder"])])),_:1}),i("div",I,[i(g,{class:"ml-2 w-32 pt-2",img:e.currentTag.imageUrl},null,8,["img"]),i(m,{class:"p-3 px-6 m-auto",text:"Bild ändern",onClick:a[8]||(a[8]=a=>e.$emit("open-image-details"))})])])};var B=e({name:"TagDetails",components:{Button:l},props:{tagId:{type:String,required:!0}},setup(e){const a=n(),l=n(),t=p(),o=f(D),r=n(!1),c=n(!1),i=g((()=>{var e,a;return!(null==(e=l.value)?void 0:e.name)||!(null==(a=l.value)?void 0:a.group)}));function d(){o.value===D?(a.value&&a.value.nfcData&&u.service("nfc-tags").update(e.tagId,a.value),t.go(-1)):o.value=D,r.value=!1}return s((async()=>{try{a.value=await u.service("nfc-tags").get(e.tagId)}finally{a.value&&a.value.nfcData?l.value=a.value:t.push("/tag-not-found")}})),{currentNfcTag:a,openImageDetails:function(){o.value=y,r.value=!0},openTrackDetails:function(){o.value=h,r.value=!0},unsavedNFCTag:l,activeDetailsPage:o,saveChanges:function(){i.value?(c.value=!0,function(){const e=document.querySelector("main");e&&e.scrollTo({top:0,behavior:"smooth"})}()):(a.value=l.value,d())},goBack:d,showBackButton:r,requiredFieldsEmpty:i,savedWithEmptyRequiredFields:c}}});const N={class:"mx-auto h-full w-full flex flex-col overflow-hidden"},q={class:"p-8 flex flex-row items-center space-x-5"},E={class:"ml-2 flex flex-col"},C=i("span",{class:"font-heading font-extralight text-2xl"},"Tag Editieren",-1),V={key:0,class:"text-m opacity-40"},F={class:"overflow-x-hidden overflow-y-auto bg-gradient-to-b from-primary to-secondary flex flex-col items-start justify-start text-2xl text-gray-800 flex-grow"},U={key:0,id:"requiredFieldsEmpty",class:"text-red-600 text-lg px-8 pt-2"},j={class:"py-5 flex-grow-0 flex items-center justify-evenly text-2xl text-gray-800"};B.render=function(e,a,l,t,n,s){const u=o("Button");return r(),c("div",N,[i("header",q,[i(u,{back:"",round:"",icon:"fas fa-times",class:"h-10 w-10 flex-shrink-0",text:""}),i("div",E,[C,e.currentNfcTag&&e.currentNfcTag.nfcData?(r(),c("span",V," Registrierte Tag-ID: #"+m(e.currentNfcTag.nfcData),1)):v("",!0)])]),i("main",F,[e.requiredFieldsEmpty&&e.savedWithEmptyRequiredFields?(r(),c("span",U," Einige notwendige Felder sind noch nicht ausgefüllt. ")):v("",!0),e.currentNfcTag&&e.currentNfcTag.nfcData?(r(),c(x(e.activeDetailsPage),{key:1,"nfc-tag":e.unsavedNFCTag,onOpenImageDetails:e.openImageDetails,onOpenTrackDetails:e.openTrackDetails},null,8,["nfc-tag","onOpenImageDetails","onOpenTrackDetails"])):v("",!0)]),i("footer",j,[e.showBackButton?(r(),c(u,{key:0,icon:"fas fa-caret-left",class:"w-14 h-14 mx-4",round:"",onClick:e.goBack},null,8,["onClick"])):v("",!0),i(u,{text:"Speichern",class:"p-3 mx-4 flex-1",onClick:e.saveChanges},null,8,["onClick"])])])};export default B;
