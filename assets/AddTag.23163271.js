import{d as e,e as a,r as t,n as l,f as n,a as s,c,g as r,h as o,u,o as p,L as d,_ as f,t as i,v as g,x as m,F as v,B as x}from"./index.3da84c45.js";import{_ as T}from"./LabeledInput.f4b141a0.js";import"./Loading.bf0970cc.js";import{a as h,_ as w}from"./AddTagStepTrack.7b7d57b7.js";import{_ as y,L as b}from"./Dropdown.1633262f.js";import{N as k}from"./nfc-tag.class.5688d583.js";var S=e({name:"AddTagStepInfo",components:{Textfield:a,Dropdown:y,LabeledInput:T},props:{nfcTag:{type:Object,required:!0}},emits:{"update:nfc-tag":e=>!0},setup(e,a){const n=t(e.nfcTag),s=t([]),c=t([]),r=t();return async function(){const e=await l.service("nfc-tags").find();e instanceof Array?e.map((e=>{e.group&&!s.value.includes(e.group)&&s.value.push(e.group)})):e.data.map((e=>{e.group&&!s.value.includes(e.group)&&s.value.push(e.group)})),s.value.map((e=>c.value.push(new b(e,e)))),r.value=c.value.find((e=>e.value===n.value.group))}().catch((()=>{throw Error("failed to load group names")})),{currentTag:n,groupListItems:c,selectedGroup:r,selectGroup:function(){var e;n.value.group=(null==(e=r.value)?void 0:e.value)||"",a.emit("update:nfc-tag",n.value)}}}});const D={class:"w-full p-4 h-full flex flex-col items-center"};S.render=function(e,a,t,l,u,p){const d=n("Textfield"),f=n("LabeledInput"),i=n("Dropdown");return s(),c("div",D,[r(f,{label:"Tag Name",class:"w-full"},{default:o((()=>[r(d,{modelValue:e.currentTag.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentTag.name=a),placeholder:"z. B. Mario Figur",class:"rounded-full",onUpdate:a[2]||(a[2]=a=>e.$emit("update:nfc-tag",e.currentTag))},null,8,["modelValue"])])),_:1}),r(f,{label:"Gruppe",class:"w-full mt-8"},{default:o((()=>[r(i,{modelValue:e.selectedGroup,"onUpdate:modelValue":[a[3]||(a[3]=a=>e.selectedGroup=a),a[5]||(a[5]=a=>e.selectGroup())],items:e.groupListItems,"onUpdate:items":a[4]||(a[4]=a=>e.groupListItems=a),removeable:!1,"placeholder-text":"WÃ¤hle eine Gruppe","enable-add-item":!0},null,8,["modelValue","items"])])),_:1})])};var j=e({name:"AddTagStepPlaceOnReader",props:{nfcTag:{type:Object,default:null}},emits:{proceed:()=>!0,"update:nfc-tag":e=>!0},setup(e,a){const n=t(),s=u(),c=e=>{(async()=>{if(!e.attachedTagData)return;(await l.service("nfc-tags").find({query:{nfcData:e.attachedTagData}})).total>0&&(alert("Der Tag wurde bereits angelegt!"),s.push({name:"home"})),n.value&&(n.value.nfcData=e.attachedTagData,a.emit("update:nfc-tag",n.value),a.emit("proceed"))})()};p((()=>{n.value=new k,a.emit("update:nfc-tag",n.value),l.service("nfc-readers").on("patched",c).on("updated",c)})),d((()=>{l.service("nfc-readers").off("patched",c).off("updated",c)}))}});const L={class:"add-tag-step-place-tag-on-reader p-6 flex h-full w-full my-auto"},I=r("img",{class:"object-contain",src:"/assets/attach-tag.59c277b1.gif"},null,-1);j.render=function(e,a,t,l,n,r){return s(),c("div",L,[I])};var C=e({name:"AddTag",components:{Button:f},setup(){const e=t(null),a=[j,S,h,w],n=t(0),s=u();return{activeStep:n,steps:a,nfcTag:e,updateTag:a=>{e.value=a},saveTag:async()=>{e.value&&(await l.service("nfc-tags").create(e.value),s.push({name:"home"}),alert("Neuen Tag erfolgreich erstellt."))},previousStep:()=>{n.value-=1},nextStep:()=>{n.value+=1}}}});const G={class:"add-tag w-full flex flex-col"},U={class:"p-8 flex flex-row"},V={class:"headlines ml-2 flex flex-col my-auto"},_=r("span",{class:"text-3xl"},"Neuen Tag anlegen",-1),A={key:0},N={class:"bg-gradient-to-b from-primary to-secondary w-full flex flex-col flex-grow overflow-y-auto"},B={class:"flex flex-col items-center"},F={class:"steps flex flex-row justify-center transform -translate-y-3 bg-white rounded-t-md px-2 py-1"},z={class:"actions flex flex-row w-full justify-center mb-4 px-4"},O={key:3,class:"text-center"};C.render=function(e,a,t,l,o,u){const p=n("Button");return s(),c("div",G,[r("header",U,[r(p,{back:"",round:"",icon:"fas fa-times",class:"h-10 w-10","icon-size":6}),r("div",V,[_,e.nfcTag&&e.nfcTag.nfcData?(s(),c("span",A,"Tag-ID: #"+i(e.nfcTag.nfcData),1)):g("",!0)])]),r("main",N,[(s(),c(m(e.steps[e.activeStep]),{"nfc-tag":e.nfcTag,"onUpdate:nfcTag":e.updateTag,onProceed:a[1]||(a[1]=a=>e.activeStep++)},null,8,["nfc-tag","onUpdate:nfcTag"]))]),r("footer",B,[r("ul",F,[(s(!0),c(v,null,x(e.steps.length,(a=>(s(),c("li",{key:a,class:"mx-2"},i(e.activeStep===a-1?"x":"o"),1)))),128))]),r("div",z,[0!==e.activeStep?(s(),c(p,{key:0,round:"","text-size":5,icon:"fas fa-chevron-left",class:"mr-4 px-4 py-2 text-center",onClick:e.previousStep},null,8,["onClick"])):g("",!0),e.activeStep===e.steps.length-1?(s(),c(p,{key:1,round:"",class:"flex-grow p-2",icon:"fas fa-download",text:"Tag erstellen",onClick:e.saveTag},null,8,["onClick"])):0!==e.activeStep?(s(),c(p,{key:2,class:"flex-grow p-2",icon:"fas fa-chevron-right",round:"",text:"Weiter",onClick:e.nextStep},null,8,["onClick"])):(s(),c("span",O,"Zum Fortfahren bitte NFC Tag an den Reader halten!"))])])])};export default C;
