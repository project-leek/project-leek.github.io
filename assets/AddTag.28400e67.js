import{d as e,k as a,r as t,a as s,c as n,e as l,f as c,u as r,o as i,j as o,l as f,m as d,t as u,F as g,h as p,_ as m,g as v,n as x}from"./index.ebb04a94.js";import{N as h,a as T,b as y}from"./AddTagStepInfo.f5bd08d5.js";var w=e({name:"AddTagStepImage",components:{TagEntry:a},props:{nfcTag:{type:Object,required:!0}},setup:()=>({})});const k={class:"add-tag-step-image flex flex-grow flex-col justify-start items-start"},b=l("div",{class:"m-8 text-lg font-semibold text-white"},"Bild von Spotify",-1);w.render=function(e,a,c,r,i,o){const f=t("TagEntry");return s(),n("div",k,[b,l(f,{class:"ml-8 w-32",img:e.nfcTag.imageUrl},null,8,["img"])])};var S=e({name:"AddTagStepPlaceOnReader",emits:["proceed","update:nfc-tag"],setup(e,a){const t=c(),s=r(),n=e=>{(async()=>{if(!e.attachedTagData)return;(await o.service("nfc-tags").find({query:{nfcData:e.attachedTagData}})).total>0&&(alert("Der Tag wurde bereits angelegt!"),s.push({name:"home"})),t.value&&(t.value.nfcData=e.attachedTagData,a.emit("update:nfc-tag",t),a.emit("proceed"))})()};i((()=>{t.value=new h,a.emit("update:nfc-tag",t),o.service("nfc-readers").on("patched",n).on("updated",n)})),f((()=>{o.service("nfc-readers").off("patched",n).off("updated",n)}))}});const j={class:"add-tag-step-place-tag-on-reader p-12"},D=l("img",{src:"/assets/attach-tag.e9d60af8.gif"},null,-1);S.render=function(e,a,t,l,c,r){return s(),n("div",j,[D])};var U=e({name:"AddTagStepTrack",components:{Textfield:T,TagEntry:a},props:{nfcTag:{type:Object,required:!0}},emits:["update:nfc-tag"],setup(e,a){const t=c(""),s=c([]),n=c(e.nfcTag),l=c(),r=c("");d(t,(async e=>{if(e.length>=3){const a={query:{name:e}};s.value=await o.service("spotify-tracks").find(a),0===s.value.length?r.value=`keine Ergebnisse fÃ¼r ${e}`:r.value="Passende Songs zu deiner Suche"}else 0===e.length&&(s.value=[],r.value="Bitte gebe einen Songtitel ein")}));return{search:t,tracks:s,changeTrack:e=>{l.value=e,n.value.spotifyTrackUri=e.uri,n.value.imageUrl=e.imageUri,a.emit("update:nfc-tag",n)},info:r}}});const C={id:"content_wrapper",class:"flex flex-col h-full"},A={class:"ml-10 text-white font-heading"},E={class:"w-full h-96 mt-5 overflow-y-auto"},q={id:"liste",class:"flex flex-col w-full"},B={class:"flex flex-col"},N={class:"ml-4 text-lg"},F={class:"ml-4 text-base"};U.render=function(e,a,c,r,i,o){const f=t("Textfield"),d=t("TagEntry");return s(),n("div",C,[l(f,{modelValue:e.search,"onUpdate:modelValue":a[1]||(a[1]=a=>e.search=a),class:"mx-auto -mt-4 mb-4",placeholder:"Titelsuche",icon:"fas fa-search"},null,8,["modelValue"]),l("span",A,u(e.info),1),l("div",E,[l("div",q,[(s(!0),n(g,null,p(e.tracks,(a=>(s(),n("div",{key:a._id,class:"flex flex-row py-2 px-2 hover:bg-primary rounded-2xl w-5/6 mx-auto",onClick:t=>e.changeTrack(a)},[l(d,{img:a.imageUri,class:"w-16"},null,8,["img"]),l("div",B,[l("span",N,u(a.title),1),l("span",F,u(a.artists.join(", ")),1)])],8,["onClick"])))),128))])])])};var I=e({name:"AddTag",components:{Button:m},setup(){const e=c(null),a=[S,y,U,w],t=c(0),s=r();return{activeStep:t,steps:a,nfcTag:e,updateTag:a=>{a.value?e.value=a.value:e.value=a},saveTag:async()=>{e.value&&(await o.service("nfc-tags").create(e.value),s.push({name:"home"}),alert("Neuen Tag erfolgreich erstellt."))}}}});const O={class:"add-tag w-full flex flex-col"},P={class:"p-8 flex flex-row"},V={class:"headlines ml-2 flex flex-col"},_=l("span",null,"Neuen Tag anlegen",-1),z={key:0},R={class:"bg-yellow-400 w-full flex-grow"},W={class:"flex flex-col items-center"},Z={class:"steps flex flex-row justify-center transform -translate-y-3 bg-white rounded-t-md px-2 py-1"},$={class:"actions flex flex-row justify-center mb-4"},G={key:3,class:"text-center"};I.render=function(e,a,c,r,i,o){const f=t("Button");return s(),n("div",O,[l("header",P,[l(f,{back:"",round:"",icon:"fas fa-times",class:"h-7 w-7"}),l("div",V,[_,e.nfcTag&&e.nfcTag.nfcData?(s(),n("span",z,"Tag-ID: #"+u(e.nfcTag.nfcData),1)):v("",!0)])]),l("div",R,[(s(),n(x(e.steps[e.activeStep]),{"nfc-tag":e.nfcTag,"onUpdate:nfcTag":e.updateTag,onProceed:a[1]||(a[1]=a=>e.activeStep++)},null,8,["nfc-tag","onUpdate:nfcTag"]))]),l("footer",W,[l("ul",Z,[(s(!0),n(g,null,p(e.steps.length,(a=>(s(),n("li",{key:a,class:"mx-2"},u(e.activeStep===a-1?"x":"o"),1)))),128))]),l("div",$,[0!==e.activeStep?(s(),n(f,{key:0,round:"","text-size":5,icon:"fas fa-chevron-left",class:"mr-4 px-4 py-2 text-center",onClick:a[2]||(a[2]=a=>e.activeStep--)})):v("",!0),e.activeStep===e.steps.length-1?(s(),n(f,{key:1,round:"",class:"flex-grow p-2",icon:"fas fa-download",text:"Tag erstellen",onClick:e.saveTag},null,8,["onClick"])):0!==e.activeStep?(s(),n(f,{key:2,class:"flex-grow p-2",icon:"fas fa-chevron-right",round:"",text:"Weiter",onClick:a[3]||(a[3]=a=>e.activeStep++)})):(s(),n("span",G,"Zum Fortfahren bitte NFC Tag an den Reader halten!"))])])])};export default I;
